

# 双人日记 (LoveSync Diary)

一款专为情侣设计的实时协作日记应用，让双方能够共享生活点滴、同步心情记录，打造属于两人的私密空间。支持实时编辑、内容同步、心情统计与互动功能，让情感记录更有温度。还有商城购物、秒杀、本地生活服务(正在开发中)。

## 🌟 核心功能

- **实时协作编辑**：基于 Operational Transformation � - 算法，支持双人同时编辑同一篇日记，内容实时同步且无冲突
- **心情记录与统计**：用不同颜色标记每日心情，自动生成每周 / 每月心情趋势图表
- **内容分享与权限管理**：可选择日记是否对伴侣可见，保护隐私的同时增进了解
- **历史记录与版本回溯**：自动保存编辑历史，支持查看和恢复过往版本
- **响应式设计**：适配手机、平板和电脑，随时随地记录生活
- **AI 智能助手**：接入大语言模型，提供功能指引、情感建议与互动陪伴

## 🚀 快速开始

### 环境要求

查看 requirements.txt

### 本地部署步骤

克隆仓库

bash
git clone https://github.com/yourusername/lovesync-diary.git
cd lovesync-diary

创建虚拟环境并安装依赖

bash
python -m venv venv
source venv/bin/activate  # Windows: venv\Scripts\activate
pip install -r requirements.txt

配置环境变量

创建 .env 文件，填写必要配置：

ini
DEBUG=True
SECRET_KEY=your_secret_key
DATABASE_URL=postgres://user:password@localhost:5432/lovesync
REDIS_URL=redis://localhost:6379/0

初始化数据库

python manage.py migrate
python manage.py createsuperuser  # 创建管理员账号

启动服务

# 启动 Django 开发服务器
python manage.py runserver

# 启动 Channels 实时通信服务
daphne lovesync.asgi:application

访问应用

- 主应用：http://127.0.0.1:8000
- 管理后台：http://127.0.0.1:8000/admin

## 📱 功能使用指南

1. **账号绑定**：注册账号后，通过「设置 → 伴侣绑定」生成邀请码。对方输入邀请码完成绑定，双方即可共享权限内的日记内容。绑定后可在「设置 → 隐私权限」中调整默认分享权限。
2. **核心功能详情**：
   - ✏️ 日记
   - 📢 动态：记录情侣间的重要时刻，支持文字、图片、短视频形式。动态会自动同步到双方首页时间线，显示 “XX 分钟前” 等时间标记。可设置 “仅双方可见” 或 “隐藏动态”（如小秘密）。
   - ⭐ 收藏：「我的 → 收藏」可保存喜欢的内容，如自己或伴侣的日记 / 博客片段、社区中看到的优质内容、商城链接的重要对话截图。支持创建收藏夹分类（如 “约会灵感”、“礼物清单”、“感情语录”）。收藏内容更新时（如原作者修改）会收到提醒，可直接将收藏内容分享到双方聊天窗口。
3. **数据统计**：首页展示「本周心情」统计，用颜色分布直观呈现双方情绪变化

## 🤖 AI 功能详情

1. **功能指引**：实时解答操作疑问（如“如何恢复误删日记？”、“怎样创建共享相册？”），分步引导使用复杂功能（如协作编辑、权限设置），主动推荐场景化功能组合（如“纪念日提醒 + 日记模板”搭配使用）。
2. **情感陪伴**：提供矛盾沟通建议（如“冷战时适合写一封和解日记”），生成个性化纪念日祝福文案、情话灵感，基于双方记录的心情数据，温和提醒情感维护（如“最近双方心情波动较大，试试共同写一篇回忆日记吧”）。
3. **内容辅助**：日记写作灵感推荐（按季节、节日、关系阶段生成主题），相册旁白自动补全（根据照片内容生成温馨描述），社区动态文案优化建议（保持原意的同时增强感染力）。
4. **隐私保护**：AI 仅处理公开功能逻辑与用户主动提问内容，不存储或分析私密日记内容，确保情侣隐私安全。

## 🔧 技术亮点

- 运用 multithreading 优化实时编辑体验，结合 Operational Transformation � - 降低情侣内容同步延迟，防止多线程同时操作共享内容时的数据一致性问题与同步延迟问题。
- 基于 Redis 实现双层缓存架构，存储用户会话信息（结合 JWT 令牌），缓存情侣账号绑定关系与权限数据，将接口响应时间降低，实现热门话题排行榜的实时更新，避免了缓存击穿、接口响应缓慢导致的用户体验下降，以及权限数据访问效率低的问题。
- 通过观察者模式实时监听日记编辑、商场操作等用户行为，触发埋点数据采集，再由工厂模式统一生成标准化埋点事件，调用接口完成数据存储，结合用户行为优化推荐精准度。

## 🤝 贡献指南

欢迎参与项目开发！无论是功能优化、Bug 修复还是文档完善，都可以通过以下步骤贡献：

- 请确保代码符合项目编码规范，并添加必要的测试用例。

## 📄 开源协议

本项目采用 MIT 协议开源，允许自由使用、修改和分发，详情见 LICENSE 文件。

## 💬 联系我们

- 项目地址：https://github.com/WENdaoshui-shou/LoveSync_Diary.git
- 问题反馈：提交 Issues
- 开发者：[你的名字 / 团队名]（邮箱：your@email.com）