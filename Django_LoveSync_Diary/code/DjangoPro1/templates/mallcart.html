<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LoveSync 情侣商城 - 购物车</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#FF6B8B', // 爱情粉色作为主色调
                        secondary: '#722ED1', // 紫色作为辅助色
                        neutral: {
                            100: '#F9F9F9',
                            200: '#F0F0F0',
                            300: '#E0E0E0',
                            400: '#BDBDBD',
                            500: '#9E9E9E',
                            600: '#757575',
                            700: '#616161',
                            800: '#424242',
                            900: '#212121',
                        }
                    },
                    fontFamily: {
                        inter: ['Inter', 'sans-serif'],
                    },
                }
            }
        }
    </script>
    <style type="text/tailwindcss">
        @layer utilities {
            .transition-custom {
                transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            }

            .bg-gradient-love {
                background: linear-gradient(135deg, #FF6B8B 0%, #722ED1 100%);
            }

            .hover-scale {
                transition: transform 0.3s ease;
            }

            .hover-scale:hover {
                transform: scale(1.03);
            }

            .form-input-focus {
                transition: all 0.3s ease;
            }

            .form-input-focus:focus {
                transform: translateY(-2px);
                box-shadow: 0 10px 25px -5px rgba(255, 107, 139, 0.1), 0 10px 10px -5px rgba(255, 107, 139, 0.04);
            }

            .btn-pulse {
                animation: pulse 2s infinite;
            }

            @keyframes pulse {
                0% {
                    box-shadow: 0 0 0 0 rgba(255, 107, 139, 0.4);
                }
                70% {
                    box-shadow: 0 0 0 10px rgba(255, 107, 139, 0);
                }
                100% {
                    box-shadow: 0 0 0 0 rgba(255, 107, 139, 0);
                }
            }

            .float-animation {
                animation: float 6s ease-in-out infinite;
            }

            @keyframes float {
                0% {
                    transform: translateY(0px);
                }
                50% {
                    transform: translateY(-20px);
                }
                100% {
                    transform: translateY(0px);
                }
            }

            .product-card {
                transition: all 0.3s ease;
            }

            .product-card:hover {
                box-shadow: 0 15px 30px rgba(0, 0, 0, 0.1);
                transform: translateY(-5px);
            }

            .scrollbar-hide::-webkit-scrollbar {
                display: none;
            }

            .scrollbar-hide {
                -ms-overflow-style: none;
                scrollbar-width: none;
            }

            .text-shadow {
                text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            }

            .text-gradient {
                background-clip: text;
                -webkit-background-clip: text;
                color: transparent;
                background-image: linear-gradient(135deg, #FF6B8B 0%, #722ED1 100%);
            }

            .card-shadow {
                box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.05), 0 10px 10px -5px rgba(0, 0, 0, 0.01);
            }

            .toast-notification {
                z-index: 9999;
            }
        }
    </style>
</head>

<body class="font-inter bg-neutral-100 text-neutral-800 min-h-screen flex flex-col overflow-x-hidden relative">
    <!-- 背景装饰元素 -->
    <div class="absolute top-0 left-0 w-full h-full overflow-hidden pointer-events-none">
        <div class="absolute -top-40 -left-40 w-80 h-80 bg-primary/10 rounded-full filter blur-3xl float-animation">
        </div>
        <div class="absolute -bottom-20 -right-20 w-80 h-80 bg-secondary/10 rounded-full filter blur-3xl float-animation"
            style="animation-delay: -2s;"></div>
        <div class="absolute top-1/3 right-1/4 w-40 h-40 bg-primary/5 rounded-full filter blur-2xl float-animation"
            style="animation-delay: -4s;"></div>
    </div>

    <!-- 导航栏 -->
    <header class="fixed w-full top-0 z-50 transition-all duration-300 bg-white/95 backdrop-blur-md shadow-sm py-3">
        <div class="container mx-auto px-4 flex items-center justify-between">
            <!-- 品牌标识 -->
            <a href="{% url 'index' %}" class="flex items-center space-x-2">
                <div
                    class="w-10 h-10 rounded-full bg-gradient-love flex items-center justify-center text-white shadow-md">
                    <i class="fa-solid fa-heart text-xl"></i>
                </div>
                <span class="text-xl font-bold text-neutral-800 tracking-tight">LoveSync</span>
            </a>

            <!-- 桌面端导航菜单 -->
            <nav class="hidden md:flex items-center space-x-6">
                <a href="{% url 'community' %}"
                    class="text-neutral-700 hover:text-primary transition-custom font-medium px-1 py-2 border-b-2 border-transparent hover:border-primary">爱享公社</a>
                <a href="{% url 'moments' %}"
                    class="text-neutral-700 hover:text-primary transition-custom font-medium px-1 py-2 border-b-2 border-transparent hover:border-primary">心动轨迹</a>
                <a href="{% url 'photo_album' %}"
                    class="text-neutral-700 hover:text-primary transition-custom font-medium px-1 py-2 border-b-2 border-transparent hover:border-primary">心跳相簿</a>
                <a href="{% url 'lovesync' %}"
                    class="text-neutral-700 hover:text-primary transition-custom font-medium px-1 py-2 border-b-2 border-transparent hover:border-primary">双人日记</a>

                <!-- 更多下拉菜单 -->
                <div class="relative" id="moreDropdown">
                    <button
                        class="text-neutral-700 hover:text-primary transition-custom font-medium flex items-center px-1 py-2"
                        id="moreButton">
                        更多 <i class="fa-solid fa-chevron-down ml-1 text-xs"></i>
                    </button>
                    <div class="absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-xl py-2 z-50 hidden"
                        id="moreOptions">
                        <a href="#"
                            class="block px-4 py-2 text-neutral-700 hover:bg-neutral-50 transition-custom flex items-center">
                            <i class="fa-solid fa-calendar-heart mr-2 w-5 text-center"></i>纪念日提醒
                        </a>
                        <a href="#"
                            class="block px-4 py-2 text-neutral-700 hover:bg-neutral-50 transition-custom flex items-center">
                            <i class="fa-solid fa-gift mr-2 w-5 text-center"></i>礼物推荐
                        </a>
                        <a href="#"
                            class="block px-4 py-2 text-neutral-700 hover:bg-neutral-50 transition-custom flex items-center">
                            <i class="fa-solid fa-map-marker-heart mr-2 w-5 text-center"></i>情侣地点
                        </a>
                        <a href="#"
                            class="block px-4 py-2 text-neutral-700 hover:bg-neutral-50 transition-custom flex items-center">
                            <i class="fa-solid fa-question-circle mr-2 w-5 text-center"></i>爱情测试
                        </a>
                    </div>
                </div>
            </nav>

            <!-- 内容过滤器 -->
            <div
                class="bg-white/95 backdrop-blur-md rounded-xl shadow-lg p-2 flex justify-between items-center hover-scale">
                <div class="relative w-full">
                    <input type="text" placeholder="搜索情侣商品..."
                        class="pl-10 pr-40 py-2 rounded-full border border-neutral-200 focus:outline-none focus:ring-2 focus:ring-primary/50 form-input-focus text-sm w-full">
                    <i class="fa-solid fa-search absolute left-4 top-1/2 -translate-y-1/2 text-neutral-400"></i>

                    <!-- 搜索热词下拉菜单 -->
                    <div id="searchSuggestions"
                        class="absolute left-0 right-0 top-full mt-1 bg-white rounded-xl shadow-xl z-40 invisible opacity-0 transform -translate-y-2 transition-all duration-200">
                        <div class="p-3">
                            <div class="flex justify-between items-center mb-2">
                                <h4 class="font-medium text-neutral-800">热门搜索</h4>
                                <button class="text-xs text-neutral-500 hover:text-primary">清除历史</button>
                            </div>

                            <div class="space-y-2">
                                <a href="#"
                                    class="flex items-center p-2 rounded-lg hover:bg-neutral-50 transition-custom">
                                    <i class="fa-solid fa-fire text-primary mr-3 w-5 text-center"></i>
                                    <span>情侣T恤夏季新款</span>
                                    <span class="ml-auto text-xs font-medium text-primary">2.5万+</span>
                                </a>

                                <a href="#"
                                    class="flex items-center p-2 rounded-lg hover:bg-neutral-50 transition-custom">
                                    <i class="fa-solid fa-fire text-primary mr-3 w-5 text-center"></i>
                                    <span>纯银情侣手链</span>
                                    <span class="ml-auto text-xs font-medium text-primary">1.8万+</span>
                                </a>

                                <a href="#"
                                    class="flex items-center p-2 rounded-lg hover:bg-neutral-50 transition-custom">
                                    <i class="fa-solid fa-fire text-primary mr-3 w-5 text-center"></i>
                                    <span>情侣保温杯</span>
                                    <span class="ml-auto text-xs font-medium text-primary">1.2万+</span>
                                </a>

                                <a href="#"
                                    class="flex items-center p-2 rounded-lg hover:bg-neutral-50 transition-custom">
                                    <i class="fa-solid fa-star text-yellow-400 mr-3 w-5 text-center"></i>
                                    <span>情侣手机壳定制</span>
                                    <span class="ml-auto text-xs font-medium text-primary">9.8千+</span>
                                </a>

                                <a href="#"
                                    class="flex items-center p-2 rounded-lg hover:bg-neutral-50 transition-custom">
                                    <i class="fa-solid fa-star text-yellow-400 mr-3 w-5 text-center"></i>
                                    <span>情侣睡衣套装</span>
                                    <span class="ml-auto text-xs font-medium text-primary">8.7千+</span>
                                </a>
                            </div>

                            <div class="border-t border-neutral-100 my-3 pt-3">
                                <h4 class="font-medium text-neutral-800 mb-2">搜索历史</h4>
                                <div class="space-y-2">
                                    <a href="#"
                                        class="flex items-center p-2 rounded-lg hover:bg-neutral-50 transition-custom">
                                        <i
                                            class="fa-solid fa-clock-rotate-left text-neutral-400 mr-3 w-5 text-center"></i>
                                        <span>情侣手表</span>
                                    </a>

                                    <a href="#"
                                        class="flex items-center p-2 rounded-lg hover:bg-neutral-50 transition-custom">
                                        <i
                                            class="fa-solid fa-clock-rotate-left text-neutral-400 mr-3 w-5 text-center"></i>
                                        <span>情侣马克杯</span>
                                    </a>

                                    <a href="#"
                                        class="flex items-center p-2 rounded-lg hover:bg-neutral-50 transition-custom">
                                        <i
                                            class="fa-solid fa-clock-rotate-left text-neutral-400 mr-3 w-5 text-center"></i>
                                        <span>情侣睡衣</span>
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>


            <!-- 用户操作区 -->
            <div class="flex items-center space-x-4">
                <!-- 返回商城按钮-->
                <a href="{% url 'mall' %}"
                    class="hidden md:flex items-center space-x-2 px-5 py-2 rounded-full bg-primary text-white hover:bg-primary/90 transition-custom shadow-sm hover:shadow-md">
                    <i class="fa-solid fa-shopping-bag"></i>
                    <span>返回商城</span>
                </a>

                <!-- 收藏按钮-->
                <a href="{% url 'mallmark' %}"
                    class="hidden md:flex items-center space-x-2 px-5 py-2 rounded-full bg-neutral-100 text-neutral-700 hover:bg-neutral-200 transition-custom shadow-sm hover:shadow-md">
                    <i class="fa-solid fa-heart"></i>
                    <span class="relative">
                        <span
                            class="absolute -top-2 -right-3 bg-primary text-white text-xs w-5 h-5 rounded-full flex items-center justify-center">3</span>
                    </span>
                </a>

                <!-- 购物车按钮-->
                <a href="{% url 'mallcart' %}"
                    class="hidden md:flex items-center space-x-2 px-5 py-2 rounded-full bg-neutral-100 text-neutral-700 hover:bg-neutral-200 transition-custom shadow-sm hover:shadow-md">
                    <i class="fa-solid fa-solid fa-shopping-cart"></i>
                    <span class="relative">
                        <span
                            class="absolute -top-2 -right-3 bg-primary text-white text-xs w-5 h-5 rounded-full flex items-center justify-center cart-count">0</span>
                    </span>
                </a>

                <!-- 用户头像与下拉菜单 -->
                <div class="relative" id="userDropdown">
                    <div class="w-10 h-10 rounded-full overflow-hidden border-2 border-primary cursor-pointer shadow-sm"
                        id="userAvatar">
                        <img src="{{ user.profile.userAvatar.url }}" alt="用户头像" class="w-full h-full object-cover">
                    </div>
                    <div class="absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-xl py-2 z-50 hidden"
                        id="userOptions">
                        <a href="{% url 'personal_center' %}"
                            class="block px-4 py-2 text-neutral-700 hover:bg-neutral-50 transition-custom flex items-center">
                            <i class="fa-solid fa-user mr-2 w-5 text-center"></i>主页
                        </a>
                        <a href="{% url 'message' %}"
                            class="block px-4 py-2 text-neutral-700 hover:bg-neutral-50 transition-custom flex items-center">
                            <i class="fa-solid fa-bookmark mr-2 w-5 text-center"></i>消息
                        </a>
                        <a href="{% url 'settings' %}"
                            class="block px-4 py-2 text-neutral-700 hover:bg-neutral-50 transition-custom flex items-center">
                            <i class="fa-solid fa-cog mr-2 w-5 text-center"></i>设置
                        </a>
                        <div class="border-t border-neutral-200 my-1"></div>
                        <a href="{% url 'logout' %}"
                            class="block px-4 py-2 text-red-500 hover:bg-red-50 transition-custom flex items-center">
                            <i class="fa-solid fa-sign-out mr-2 w-5 text-center"></i>退出登录
                        </a>
                    </div>
                </div>

                <!-- 移动端菜单按钮 -->
                <button class="md:hidden text-neutral-700 focus:outline-none" id="menu-toggle">
                    <i class="fa-solid fa-bars text-xl"></i>
                </button>
            </div>
        </div>

        <!-- 移动端菜单 -->
        <div id="mobile-menu"
            class="hidden md:hidden bg-white shadow-lg absolute w-full transform -translate-y-2 opacity-0 transition-all duration-200 ease-in-out"
            style="top: 100%;">
            <div class="container mx-auto px-4 py-3 flex flex-col space-y-3">
                <a href="{% url 'community' %}"
                    class="text-neutral-700 hover:text-primary py-2 transition-custom font-medium flex items-center">
                    <i class="fa-solid fa-users mr-3 w-5 text-center"></i>爱享公社
                </a>
                <a href="{% url 'moments' %}"
                    class="text-neutral-700 hover:text-primary py-2 transition-custom font-medium flex items-center">
                    <i class="fa-solid fa-bolt mr-3 w-5 text-center"></i>心动轨迹
                </a>
                <a href="{% url 'photo_album' %}"
                    class="text-neutral-700 hover:text-primary py-2 transition-custom font-medium flex items-center">
                    <i class="fa-solid fa-images mr-3 w-5 text-center"></i>心跳相簿
                </a>
                <a href="{% url 'lovesync' %}"
                    class="text-neutral-700 hover:text-primary py-2 transition-custom font-medium flex items-center">
                    <i class="fa-solid fa-bookmark mr-3 w-5 text-center"></i>双人日记
                </a>
                <div class="border-t border-neutral-200 my-1"></div>
                <a href="#" class="text-neutral-700 py-2 transition-custom flex items-center">
                    <i class="fa-solid fa-calendar-heart mr-3 w-5 text-center"></i>纪念日提醒
                </a>
                <a href="#" class="text-neutral-700 py-2 transition-custom flex items-center">
                    <i class="fa-solid fa-gift mr-3 w-5 text-center"></i>礼物推荐
                </a>
                <a href="#" class="text-neutral-700 py-2 transition-custom flex items-center">
                    <i class="fa-solid fa-map-marker-heart mr-3 w-5 text-center"></i>情侣地点
                </a>
                <a href="#" class="text-neutral-700 py-2 transition-custom flex items-center">
                    <i class="fa-solid fa-question-circle mr-3 w-5 text-center"></i>爱情测试
                </a>
                <div class="border-t border-neutral-200 my-1"></div>
                <a href="{% url 'personal_center' %}" class="text-neutral-700 py-2 transition-custom flex items-center">
                    <i class="fa-solid fa-user mr-3 w-5 text-center"></i>主页
                </a>
                <a href="{% url 'message' %}" class="text-neutral-700 py-2 transition-custom flex items-center">
                    <i class="fa-solid fa-bookmark mr-3 w-5 text-center"></i>消息
                </a>
                <a href="{% url 'settings' %}" class="text-neutral-700 py-2 transition-custom flex items-center">
                    <i class="fa-solid fa-cog mr-3 w-5 text-center"></i>设置
                </a>
                <div class="border-t border-neutral-200 my-1"></div>
                <a href="{% url 'logout' %}" class="text-red-500 py-2 transition-custom flex items-center">
                    <i class="fa-solid fa-sign-out mr-3 w-5 text-center"></i>退出登录
                </a>
            </div>
        </div>
    </header>

    <!-- 主内容区 -->
    <main class="flex-grow pt-32 pb-16 relative z-10">
        <div class="container mx-auto px-4">
            <!-- 页面标题 -->
            <div class="mb-8">
                <h1 class="text-[clamp(1.5rem,3vw,2.5rem)] font-bold text-neutral-800">我的购物车</h1>
            </div>

            <!-- 购物车内容 -->
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                <!-- 商品列表 -->
                <div class="lg:col-span-2">
                    <div class="bg-white rounded-xl shadow-sm overflow-hidden">
                        <!-- 购物车头部 -->
                        <div class="px-6 py-4 border-b border-neutral-200 flex items-center justify-between">
                            <h2 class="font-semibold text-lg">已选商品</h2>
                            <p class="text-neutral-600 mt-2" id="cartItemCount">共0件商品</p>
                            <div class="flex items-center space-x-4">
                            </div>
                        </div>

                        <!-- 空购物车状态 -->
                        <div id="emptyCart" class="py-16 text-center hidden">
                            <div class="w-20 h-20 mx-auto bg-neutral-100 rounded-full flex items-center justify-center">
                                <i class="fa-solid fa-shopping-cart text-2xl text-neutral-400"></i>
                            </div>
                            <h3 class="mt-4 text-lg font-medium text-neutral-800">购物车是空的</h3>
                            <p class="mt-2 text-neutral-500">快去添加心仪的商品吧</p>
                            <a href="{% url 'mall' %}"
                                class="mt-6 px-6 py-2 bg-primary text-white rounded-lg hover:bg-primary/90 transition-custom shadow-sm inline-block text-center"
                                role="button">
                                继续购物
                            </a>
                        </div>

                        <!-- 商品列表容器 -->
                        <div id="cartItemsList" class="divide-y divide-neutral-200">
                            <!-- 商品将通过JavaScript动态添加 -->
                        </div>

                        <!-- 购物车底部 -->
                        <div class="px-6 py-4 bg-neutral-50 flex items-center justify-between">
                            <div class="flex items-center space-x-4">
                                <button class="text-neutral-500 hover:text-primary transition-custom"
                                    id="addToFavoritesBtn">
                                    <i class="fa-solid fa-heart mr-1"></i> 加入收藏
                                </button>
                                <button class="text-neutral-500 hover:text-red-500 transition-custom"
                                    id="removeSelectedBtn">
                                    <i class="fa-solid fa-trash mr-1"></i> 删除选中
                                </button>
                            </div>
                            <div class="flex items-center space-x-4">
                                <span class="text-neutral-600">已选 <span class="text-primary font-medium"
                                        id="selectedCount">0</span> 件</span>
                                <label class="flex items-center cursor-pointer">
                                    <input type="checkbox"
                                        class="form-checkbox h-5 w-5 text-primary rounded border-neutral-300 focus:ring-primary"
                                        id="selectAll">
                                    <span class="ml-2 text-sm">全选</span>
                                </label>
                            </div>
                        </div>
                    </div>

                    <!-- 推荐商品 -->
                    <div class="mt-8 bg-white rounded-xl shadow-sm overflow-hidden">
                        <div class="px-6 py-4 border-b border-neutral-200">
                            <h2 class="font-semibold text-lg">猜你喜欢</h2>
                        </div>
                        <div class="p-4">
                            <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-4">
                                <!-- 推荐商品1 -->
                                <div class="rounded-lg overflow-hidden hover-scale">
                                    <div class="relative">
                                        <img src="https://picsum.photos/id/1074/200/200" alt="情侣纯棉睡衣套装"
                                            class="w-full h-36 object-cover">
                                        <div class="absolute top-2 right-2">
                                            <button
                                                class="w-7 h-7 rounded-full bg-white/80 backdrop-blur-sm flex items-center justify-center text-neutral-500 hover:text-primary transition-custom add-to-favorite"
                                                data-id="p101">
                                                <i class="fa-regular fa-heart"></i>
                                            </button>
                                        </div>
                                    </div>
                                    <div class="p-2">
                                        <h3 class="font-medium text-sm line-clamp-1">情侣纯棉睡衣套装</h3>
                                        <div class="flex items-center justify-between mt-1">
                                            <span class="text-primary font-bold text-sm">¥259</span>
                                            <button
                                                class="w-7 h-7 rounded-full bg-primary/10 text-primary flex items-center justify-center hover:bg-primary hover:text-white transition-custom add-to-cart"
                                                data-id="p101" data-name="情侣纯棉睡衣套装" data-price="259">
                                                <i class="fa-solid fa-shopping-cart"></i>
                                            </button>
                                        </div>
                                    </div>
                                </div>

                                <!-- 推荐商品2 -->
                                <div class="rounded-lg overflow-hidden hover-scale">
                                    <div class="relative">
                                        <img src="https://picsum.photos/id/1080/200/200" alt="情侣手表"
                                            class="w-full h-36 object-cover">
                                        <div class="absolute top-2 right-2">
                                            <button
                                                class="w-7 h-7 rounded-full bg-white/80 backdrop-blur-sm flex items-center justify-center text-neutral-500 hover:text-primary transition-custom add-to-favorite"
                                                data-id="p102">
                                                <i class="fa-regular fa-heart"></i>
                                            </button>
                                        </div>
                                    </div>
                                    <div class="p-2">
                                        <h3 class="font-medium text-sm line-clamp-1">情侣手表</h3>
                                        <div class="flex items-center justify-between mt-1">
                                            <span class="text-primary font-bold text-sm">¥599</span>
                                            <button
                                                class="w-7 h-7 rounded-full bg-primary/10 text-primary flex items-center justify-center hover:bg-primary hover:text-white transition-custom add-to-cart"
                                                data-id="p102" data-name="情侣手表" data-price="599">
                                                <i class="fa-solid fa-shopping-cart"></i>
                                            </button>
                                        </div>
                                    </div>
                                </div>

                                <!-- 推荐商品3 -->
                                <div class="rounded-lg overflow-hidden hover-scale">
                                    <div class="relative">
                                        <img src="https://picsum.photos/id/1082/200/200" alt="情侣蓝牙音箱"
                                            class="w-full h-36 object-cover">
                                        <div class="absolute top-2 right-2">
                                            <button
                                                class="w-7 h-7 rounded-full bg-white/80 backdrop-blur-sm flex items-center justify-center text-neutral-500 hover:text-primary transition-custom add-to-favorite"
                                                data-id="p103">
                                                <i class="fa-regular fa-heart"></i>
                                            </button>
                                        </div>
                                    </div>
                                    <div class="p-2">
                                        <h3 class="font-medium text-sm line-clamp-1">情侣蓝牙音箱</h3>
                                        <div class="flex items-center justify-between mt-1">
                                            <span class="text-primary font-bold text-sm">¥399</span>
                                            <button
                                                class="w-7 h-7 rounded-full bg-primary/10 text-primary flex items-center justify-center hover:bg-primary hover:text-white transition-custom add-to-cart"
                                                data-id="p103" data-name="情侣蓝牙音箱" data-price="399">
                                                <i class="fa-solid fa-shopping-cart"></i>
                                            </button>
                                        </div>
                                    </div>
                                </div>

                                <!-- 推荐商品4 -->
                                <div class="rounded-lg overflow-hidden hover-scale">
                                    <div class="relative">
                                        <img src="https://picsum.photos/id/1083/200/200" alt="情侣保温杯"
                                            class="w-full h-36 object-cover">
                                        <div class="absolute top-2 right-2">
                                            <button
                                                class="w-7 h-7 rounded-full bg-white/80 backdrop-blur-sm flex items-center justify-center text-neutral-500 hover:text-primary transition-custom add-to-favorite"
                                                data-id="p104">
                                                <i class="fa-regular fa-heart"></i>
                                            </button>
                                        </div>
                                    </div>
                                    <div class="p-2">
                                        <h3 class="font-medium text-sm line-clamp-1">情侣保温杯</h3>
                                        <div class="flex items-center justify-between mt-1">
                                            <span class="text-primary font-bold text-sm">¥159</span>
                                            <button
                                                class="w-7 h-7 rounded-full bg-primary/10 text-primary flex items-center justify-center hover:bg-primary hover:text-white transition-custom add-to-cart"
                                                data-id="p104" data-name="情侣保温杯" data-price="159">
                                                <i class="fa-solid fa-shopping-cart"></i>
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 订单摘要 -->
                <div class="lg:col-span-1">
                    <div class="bg-white rounded-xl shadow-sm overflow-hidden sticky top-24">
                        <div class="px-6 py-4 border-b border-neutral-200">
                            <h2 class="font-semibold text-lg">订单摘要</h2>
                        </div>

                        <div class="px-6 py-4 space-y-3">
                            <div class="flex justify-between">
                                <span class="text-neutral-600">商品总价</span>
                                <span class="font-medium" id="subtotal">¥0.00</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-neutral-600">优惠折扣</span>
                                <span class="font-medium text-red-500" id="discount">-¥0.00</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-neutral-600">运费</span>
                                <span class="font-medium text-green-500" id="shipping">免运费</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-neutral-600">税费</span>
                                <span class="font-medium" id="tax">¥0.00</span>
                            </div>
                            <div class="border-t border-neutral-200 pt-4">
                                <div class="flex justify-between">
                                    <span class="font-semibold">实付款</span>
                                    <span class="font-bold text-xl text-primary" id="total">¥0.00</span>
                                </div>
                            </div>

                            <div class="mt-4">
                                <button
                                    class="w-full py-3 bg-gradient-love text-white rounded-lg font-medium hover:opacity-90 transition-custom shadow-sm btn-pulse"
                                    id="checkoutBtn" disabled>
                                    提交订单
                                </button>
                            </div>

                            <div class="mt-3 text-center">
                                <span class="text-neutral-500 text-sm">支持多种支付方式</span>
                                <div class="flex justify-center space-x-3 mt-2">
                                    <i class="fa-brands fa-alipay text-blue-500 text-xl"></i>
                                    <i class="fa-brands fa-alipay text-blue-500 text-xl"></i>
                                    <i class="fa-brands fa-weixin text-green-500 text-xl ml-2"></i>
                                    <i class="fa-brands fa-credit-card text-neutral-600 text-xl ml-2"></i>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- 页脚 -->
    <footer class="bg-white py-12 border-t border-neutral-200">
        <div class="container mx-auto px-4">
            <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
                <div>
                    <div class="flex items-center space-x-2 mb-4">
                        <div
                            class="w-10 h-10 rounded-full bg-gradient-love flex items-center justify-center text-white">
                            <i class="fa-solid fa-heart"></i>
                        </div>
                        <span class="text-xl font-bold text-neutral-800">LoveSync</span>
                    </div>
                    <p class="text-neutral-600 mb-4">为爱定制，共享美好。打造专属于你们的情侣生活。</p>
                    <div class="flex space-x-4">
                        <a href="#" class="text-neutral-400 hover:text-white transition-custom">
                            <i class="fa-brands fa-facebook"></i>
                        </a>
                        <a href="#" class="text-neutral-400 hover:text-white transition-custom">
                            <i class="fa-brands fa-twitter"></i>
                        </a>
                        <a href="#" class="text-neutral-400 hover:text-white transition-custom">
                            <i class="fa-brands fa-tiktok"></i>
                        </a>
                        <a href="#" class="text-neutral-400 hover:text-white transition-custom">
                            <i class="fa-brands fa-weibo"></i>
                        </a>
                        <a href="#" class="text-neutral-400 hover:text-white transition-custom">
                            <i class="fa-brands fa-youtube"></i>
                        </a>
                        <a href="#" class="text-neutral-400 hover:text-white transition-custom">
                            <i class="fa-brands fa-bilibili"></i>
                        </a>
                    </div>
                </div>

                <div>
                    <h3 class="font-semibold text-lg mb-4">关于我们</h3>
                    <ul class="space-y-2">
                        <li><a href="#" class="text-neutral-600 hover:text-primary transition-custom">公司简介</a></li>
                        <li><a href="#" class="text-neutral-600 hover:text-primary transition-custom">加入我们</a></li>
                        <li><a href="#" class="text-neutral-600 hover:text-primary transition-custom">联系方式</a></li>
                        <li><a href="#" class="text-neutral-600 hover:text-primary transition-custom">隐私政策</a></li>
                        <li><a href="#" class="text-neutral-600 hover:text-primary transition-custom">服务条款</a></li>
                    </ul>
                </div>

                <div>
                    <h3 class="font-semibold text-lg mb-4">帮助中心</h3>
                    <ul class="space-y-2">
                        <li><a href="#" class="text-neutral-600 hover:text-primary transition-custom">常见问题</a></li>
                        <li><a href="#" class="text-neutral-600 hover:text-primary transition-custom">购物指南</a></li>
                        <li><a href="#" class="text-neutral-600 hover:text-primary transition-custom">支付方式</a></li>
                        <li><a href="#" class="text-neutral-600 hover:text-primary transition-custom">配送说明</a></li>
                        <li><a href="#" class="text-neutral-600 hover:text-primary transition-custom">退换政策</a></li>
                    </ul>
                </div>

                <div>
                    <h3 class="font-semibold text-lg mb-4">客户服务</h3>
                    <ul class="space-y-2">
                        <li><a href="#" class="text-neutral-600 hover:text-primary transition-custom">在线客服</a></li>
                        <li><a href="#" class="text-neutral-600 hover:text-primary transition-custom">客服电话</a></li>
                        <li><a href="#" class="text-neutral-600 hover:text-primary transition-custom">工作时间</a></li>
                        <li><a href="#" class="text-neutral-600 hover:text-primary transition-custom">意见反馈</a></li>
                    </ul>
                </div>

            </div>

            <div class="border-t border-neutral-200 mt-8 pt-8 flex flex-col md:flex-row justify-between items-center">
                <p class="text-neutral-500 text-sm mb-4 md:mb-0">© 2025 LoveSync. 保留所有权利。</p>
                <div class="flex space-x-4">
                    <a href="#" class="text-neutral-500 hover:text-primary text-sm transition-custom">隐私政策</a>
                    <a href="#" class="text-neutral-500 hover:text-primary text-sm transition-custom">服务条款</a>
                    <a href="#" class="text-neutral-500 hover:text-primary text-sm transition-custom">网站地图</a>
                </div>
            </div>
        </div>
    </footer>

    <!-- 通知提示框 -->
    <div id="toastNotification"
        class="fixed bottom-4 right-4 bg-white rounded-lg shadow-lg p-4 transform translate-y-20 opacity-0 transition-all duration-300 toast-notification flex items-center">
        <div id="toastIcon"
            class="w-8 h-8 rounded-full flex items-center justify-center mr-3 bg-primary/10 text-primary">
            <i class="fa-solid fa-check"></i>
        </div>
        <div>
            <h4 id="toastTitle" class="font-medium text-neutral-800">操作成功</h4>
            <p id="toastMessage" class="text-sm text-neutral-600">商品已成功加入购物车</p>
        </div>
        <button id="closeToast" class="ml-4 text-neutral-400 hover:text-neutral-600">
            <i class="fa-solid fa-times"></i>
        </button>
    </div>

    <!-- JavaScript -->
    <script>
        // 导航栏滚动效果
        const header = document.querySelector('header');
        window.addEventListener('scroll', function () {
            if (window.scrollY > 50) {
                header.classList.add('py-2', 'shadow-md');
                header.classList.remove('py-3', 'shadow-sm');
            } else {
                header.classList.add('py-3', 'shadow-sm');
                header.classList.remove('py-2', 'shadow-md');
            }
        });

        // 更多下拉菜单 - 鼠标悬停效果
        const moreButton = document.getElementById('moreButton');
        const moreOptions = document.getElementById('moreOptions');
        const moreDropdown = document.getElementById('moreDropdown');
        let moreCloseTimer;

        // 鼠标经过按钮时打开菜单
        moreButton.addEventListener('mouseenter', function () {
            clearTimeout(moreCloseTimer);
            moreOptions.classList.remove('hidden');
            userOptions.classList.add('hidden');
            searchSuggestions.classList.add('invisible', 'opacity-0', 'transform', '-translate-y-2');
        });

        // 鼠标悬停在下拉菜单时保持菜单打开
        moreDropdown.addEventListener('mouseenter', function () {
            clearTimeout(moreCloseTimer);
        });

        // 鼠标离开下拉菜单时关闭菜单
        moreDropdown.addEventListener('mouseleave', function () {
            moreCloseTimer = setTimeout(() => {
                moreOptions.classList.add('hidden');
            }, 300);
        });

        // 用户下拉菜单 - 鼠标悬停效果
        const userAvatar = document.getElementById('userAvatar');
        const userOptions = document.getElementById('userOptions');
        const userDropdown = document.getElementById('userDropdown');
        let userCloseTimer;

        // 鼠标经过头像时打开菜单
        userAvatar.addEventListener('mouseenter', function () {
            clearTimeout(userCloseTimer);
            userOptions.classList.remove('hidden');
            moreOptions.classList.add('hidden');
            searchSuggestions.classList.add('invisible', 'opacity-0', 'transform', '-translate-y-2');
        });

        // 鼠标悬停在下拉菜单时保持菜单打开
        userDropdown.addEventListener('mouseenter', function () {
            clearTimeout(userCloseTimer);
        });

        // 鼠标离开下拉菜单时关闭菜单
        userDropdown.addEventListener('mouseleave', function () {
            userCloseTimer = setTimeout(() => {
                userOptions.classList.add('hidden');
            }, 300);
        });

        // 移动端菜单
        const menuToggle = document.getElementById('menu-toggle');
        const mobileMenu = document.getElementById('mobile-menu');

        menuToggle.addEventListener('click', function (e) {
            e.stopPropagation();
            if (mobileMenu.classList.contains('hidden')) {
                mobileMenu.classList.remove('hidden', 'opacity-0', '-translate-y-2');
                mobileMenu.classList.add('opacity-100', 'translate-y-0');
            } else {
                mobileMenu.classList.add('opacity-0', '-translate-y-2');
                setTimeout(() => {
                    mobileMenu.classList.add('hidden');
                }, 200);
            }
        });

        // 搜索框功能增强
        const searchInput = document.querySelector('input[placeholder="搜索情侣商品..."]');
        const searchSuggestions = document.getElementById('searchSuggestions');
        const clearSearchBtn = document.getElementById('clearSearch');
        const clearHistoryBtn = document.getElementById('clearHistory');

        // 搜索建议框显示/隐藏
        if (searchInput && searchSuggestions) {
            searchInput.addEventListener('focus', function () {
                searchSuggestions.classList.remove('invisible', 'opacity-0', 'transform', '-translate-y-2');
                userOptions.classList.add('hidden');
                moreOptions.classList.add('hidden');
            });

            searchInput.addEventListener('blur', function () {
                setTimeout(() => {
                    searchSuggestions.classList.add('invisible', 'opacity-0', 'transform', '-translate-y-2');
                }, 200);
            });

            // 输入内容时显示清除按钮
            searchInput.addEventListener('input', function () {
                if (this.value.trim() !== '') {
                    clearSearchBtn.classList.remove('hidden');
                } else {
                    clearSearchBtn.classList.add('hidden');
                }
            });
        }

        // 清除搜索框内容
        if (clearSearchBtn) {
            clearSearchBtn.addEventListener('click', function (e) {
                e.stopPropagation();
                searchInput.value = '';
                searchInput.focus();
                clearSearchBtn.classList.add('hidden');
            });
        }

        // 清除搜索历史
        if (clearHistoryBtn) {
            clearHistoryBtn.addEventListener('click', function (e) {
                e.stopPropagation();
                const historyItems = document.querySelectorAll('#searchSuggestions .flex.items-center.justify-between');
                historyItems.forEach(item => {
                    if (!item.classList.contains('text-neutral-500')) {
                        item.style.transition = 'all 0.3s ease';
                        item.style.opacity = '0';
                        item.style.height = '0';
                        item.style.margin = '0';
                        setTimeout(() => {
                            item.remove();
                        }, 300);
                    }
                });
            });
        }

        // 初始化购物车数据
        let cartItems = [];

        // 模拟从后端获取购物车数据
        function fetchCartData() {
            // 实际项目中应该从后端API获取数据
            // 这里使用模拟数据

            // 从localStorage获取购物车数据
            const savedCart = localStorage.getItem('lovesync_cart');
            if (savedCart) {
                try {
                    cartItems = JSON.parse(savedCart);
                } catch (e) {
                    console.error('Failed to parse cart data:', e);
                    cartItems = [];
                }
            }

            // 更新购物车UI
            updateCartUI();
        }

        // 更新购物车UI
        function updateCartUI() {
            const cartItemsList = document.getElementById('cartItemsList');
            const emptyCart = document.getElementById('emptyCart');
            const cartItemCount = document.getElementById('cartItemCount');
            const subtotalElement = document.getElementById('subtotal');
            const discountElement = document.getElementById('discount');
            const taxElement = document.getElementById('tax');
            const totalElement = document.getElementById('total');
            const checkoutBtn = document.getElementById('checkoutBtn');
            const cartCountBadge = document.querySelector('.cart-count');

            // 更新购物车商品数量徽章
            cartCountBadge.textContent = cartItems.length;

            // 清空现有商品列表
            cartItemsList.innerHTML = '';

            // 计算总计
            let subtotal = 0;
            let discount = 0;
            let taxRate = 0.1; // 10%税率
            let tax = 0;
            let total = 0;
            let selectedCount = 0;

            if (cartItems.length === 0) {
                // 显示空购物车状态
                emptyCart.classList.remove('hidden');
                cartItemCount.textContent = '共0件商品';
                checkoutBtn.disabled = true;
                checkoutBtn.classList.add('opacity-50', 'cursor-not-allowed');
            } else {
                // 隐藏空购物车状态
                emptyCart.classList.add('hidden');
                cartItemCount.textContent = `共${cartItems.length}件商品`;
                checkoutBtn.disabled = false;
                checkoutBtn.classList.remove('opacity-50', 'cursor-not-allowed');

                // 添加商品到购物车列表
                cartItems.forEach((item, index) => {
                    const itemTotal = item.price * item.quantity;
                    subtotal += itemTotal;

                    // 创建商品项HTML
                    const itemHTML = document.createElement('div');
                    itemHTML.className = 'p-4 flex items-center';
                    itemHTML.innerHTML = `
                        <div class="mr-4">
                            <input type="checkbox" class="form-checkbox h-5 w-5 text-primary rounded border-neutral-300 focus:ring-primary cart-item-checkbox" ${item.selected ? 'checked' : ''} data-index="${index}">
                        </div>
                        <div class="w-16 h-16 rounded-lg overflow-hidden mr-4 flex-shrink-0">
                            <img src="https://picsum.photos/id/${1000 + index}/100/100" alt="${item.name}" class="w-full h-full object-cover">
                        </div>
                        <div class="flex-grow">
                            <h3 class="font-medium text-neutral-800">${item.name}</h3>
                            <p class="text-sm text-neutral-500 mt-1">款式: ${item.style || '默认'}</p>
                        </div>
                        <div class="flex flex-col items-end ml-4">
                            <div class="font-bold text-primary">¥${item.price.toFixed(2)}</div>
                            <div class="flex items-center mt-2 border border-neutral-200 rounded-lg overflow-hidden">
                                <button class="px-2 py-1 text-neutral-500 hover:text-primary decrease-quantity" data-index="${index}">
                                    <i class="fa-solid fa-minus"></i>
                                </button>
                                <input type="number" value="${item.quantity}" min="1" class="w-10 text-center text-sm border-x border-neutral-200 focus:outline-none quantity-input" data-index="${index}">
                                <button class="px-2 py-1 text-neutral-500 hover:text-primary increase-quantity" data-index="${index}">
                                    <i class="fa-solid fa-plus"></i>
                                </button>
                            </div>
                            <div class="font-bold text-primary mt-2">¥${itemTotal.toFixed(2)}</div>
                            <button class="text-neutral-400 hover:text-red-500 mt-2 remove-item" data-index="${index}">
                                <i class="fa-solid fa-trash"></i>
                            </button>
                        </div>
                    `;

                    cartItemsList.appendChild(itemHTML);

                    // 计算选中商品数量
                    if (item.selected) {
                        selectedCount++;
                    }
                });

                // 计算折扣 (模拟)
                discount = subtotal > 500 ? 50 : 0;

                // 计算税费
                tax = (subtotal - discount) * taxRate;

                // 计算总计
                total = subtotal - discount + tax;

                // 更新订单摘要
                subtotalElement.textContent = `¥${subtotal.toFixed(2)}`;
                discountElement.textContent = `-¥${discount.toFixed(2)}`;
                taxElement.textContent = `¥${tax.toFixed(2)}`;
                totalElement.textContent = `¥${total.toFixed(2)}`;
            }

            // 更新已选商品数量
            document.getElementById('selectedCount').textContent = selectedCount;

            // 更新全选按钮状态
            const selectAllCheckbox = document.getElementById('selectAll');
            selectAllCheckbox.checked = selectedCount > 0 && selectedCount === cartItems.length;

            // 保存购物车数据到localStorage
            saveCartData();
        }

        // 保存购物车数据到localStorage
        function saveCartData() {
            localStorage.setItem('lovesync_cart', JSON.stringify(cartItems));
        }

        // 显示通知提示框
        function showToast(title, message, isSuccess = true) {
            const toastNotification = document.getElementById('toastNotification');
            const toastTitle = document.getElementById('toastTitle');
            const toastMessage = document.getElementById('toastMessage');
            const toastIcon = document.getElementById('toastIcon');

            toastTitle.textContent = title;
            toastMessage.textContent = message;

            // 设置图标和颜色
            if (isSuccess) {
                toastIcon.className = 'w-8 h-8 rounded-full flex items-center justify-center mr-3 bg-green-100 text-green-500';
                toastIcon.innerHTML = '<i class="fa-solid fa-check"></i>';
            } else {
                toastIcon.className = 'w-8 h-8 rounded-full flex items-center justify-center mr-3 bg-red-100 text-red-500';
                toastIcon.innerHTML = '<i class="fa-solid fa-times"></i>';
            }

            // 显示提示框
            toastNotification.classList.remove('translate-y-20', 'opacity-0');

            // 3秒后自动关闭
            setTimeout(() => {
                hideToast();
            }, 3000);
        }

        // 隐藏通知提示框
        function hideToast() {
            const toastNotification = document.getElementById('toastNotification');
            toastNotification.classList.add('translate-y-20', 'opacity-0');
        }

        // 事件监听
        document.addEventListener('DOMContentLoaded', () => {
            // 获取购物车数据
            fetchCartData();

            // 导航菜单下拉
            const moreButton = document.getElementById('moreButton');
            const moreOptions = document.getElementById('moreOptions');

            moreButton.addEventListener('click', () => {
                moreOptions.classList.toggle('hidden');
            });

            // 用户菜单下拉
            const userAvatar = document.getElementById('userAvatar');
            const userOptions = document.getElementById('userOptions');

            userAvatar.addEventListener('click', () => {
                userOptions.classList.toggle('hidden');
            });

            // 移动端菜单
            const menuToggle = document.getElementById('menu-toggle');
            const mobileMenu = document.getElementById('mobile-menu');

            menuToggle.addEventListener('click', () => {
                if (mobileMenu.classList.contains('hidden')) {
                    mobileMenu.classList.remove('hidden');
                    setTimeout(() => {
                        mobileMenu.classList.remove('transform', '-translate-y-2', 'opacity-0');
                    }, 10);
                } else {
                    mobileMenu.classList.add('transform', '-translate-y-2', 'opacity-0');
                    setTimeout(() => {
                        mobileMenu.classList.add('hidden');
                    }, 200);
                }
            });

            // 搜索框下拉菜单
            const searchInput = document.querySelector('input[placeholder="搜索情侣商品..."]');
            const searchSuggestions = document.getElementById('searchSuggestions');

            searchInput.addEventListener('focus', () => {
                searchSuggestions.classList.remove('invisible', 'opacity-0', '-translate-y-2');
            });

            searchInput.addEventListener('blur', () => {
                setTimeout(() => {
                    searchSuggestions.classList.add('invisible', 'opacity-0', '-translate-y-2');
                }, 200);
            });

            // 全选/取消全选
            const selectAllCheckbox = document.getElementById('selectAll');

            selectAllCheckbox.addEventListener('change', () => {
                const isChecked = selectAllCheckbox.checked;

                cartItems.forEach(item => {
                    item.selected = isChecked;
                });

                updateCartUI();
            });

            // 为购物车项目复选框添加事件委托
            document.getElementById('cartItemsList').addEventListener('change', (e) => {
                if (e.target.classList.contains('cart-item-checkbox')) {
                    const index = parseInt(e.target.getAttribute('data-index'));
                    cartItems[index].selected = e.target.checked;
                    updateCartUI();
                }
            });

            // 为数量增减按钮添加事件委托
            document.getElementById('cartItemsList').addEventListener('click', (e) => {
                if (e.target.closest('.decrease-quantity')) {
                    const button = e.target.closest('.decrease-quantity');
                    const index = parseInt(button.getAttribute('data-index'));
                    if (cartItems[index].quantity > 1) {
                        cartItems[index].quantity--;
                        updateCartUI();
                    }
                } else if (e.target.closest('.increase-quantity')) {
                    const button = e.target.closest('.increase-quantity');
                    const index = parseInt(button.getAttribute('data-index'));
                    cartItems[index].quantity++;
                    updateCartUI();
                } else if (e.target.closest('.remove-item')) {
                    const button = e.target.closest('.remove-item');
                    const index = parseInt(button.getAttribute('data-index'));

                    // 显示确认对话框
                    if (confirm('确定要删除这件商品吗？')) {
                        cartItems.splice(index, 1);
                        updateCartUI();
                        showToast('删除成功', '商品已从购物车中移除');
                    }
                }
            });

            // 为数量输入框添加事件委托
            document.getElementById('cartItemsList').addEventListener('change', (e) => {
                if (e.target.classList.contains('quantity-input')) {
                    const input = e.target;
                    const index = parseInt(input.getAttribute('data-index'));
                    let quantity = parseInt(input.value);

                    if (isNaN(quantity) || quantity < 1) {
                        quantity = 1;
                        input.value = 1;
                    }

                    cartItems[index].quantity = quantity;
                    updateCartUI();
                }
            });

            // 为推荐商品的加入购物车按钮添加事件委托
            document.querySelectorAll('.add-to-cart').forEach(button => {
                button.addEventListener('click', () => {
                    const id = button.getAttribute('data-id');
                    const name = button.getAttribute('data-name');
                    const price = parseFloat(button.getAttribute('data-price'));

                    // 检查商品是否已在购物车中
                    const existingItemIndex = cartItems.findIndex(item => item.id === id);

                    if (existingItemIndex !== -1) {
                        // 商品已在购物车中，增加数量
                        cartItems[existingItemIndex].quantity++;
                    } else {
                        // 商品不在购物车中，添加新商品
                        cartItems.push({
                            id,
                            name,
                            price,
                            quantity: 1,
                            selected: true,
                            style: '默认'
                        });
                    }

                    updateCartUI();
                    showToast('添加成功', '商品已成功加入购物车');
                });
            });

            // 为推荐商品的加入收藏按钮添加事件委托
            document.querySelectorAll('.add-to-favorite').forEach(button => {
                button.addEventListener('click', () => {
                    const icon = button.querySelector('i');

                    if (icon.classList.contains('fa-regular')) {
                        icon.classList.remove('fa-regular');
                        icon.classList.add('fa-solid');
                        button.classList.add('text-primary');
                        showToast('收藏成功', '商品已添加到收藏夹');
                    } else {
                        icon.classList.remove('fa-solid');
                        icon.classList.add('fa-regular');
                        button.classList.remove('text-primary');
                        showToast('取消收藏', '商品已从收藏夹中移除');
                    }
                });
            });

            // 删除选中商品
            document.getElementById('removeSelectedBtn').addEventListener('click', () => {
                const selectedItemsCount = cartItems.filter(item => item.selected).length;

                if (selectedItemsCount === 0) {
                    showToast('操作失败', '请先选择要删除的商品', false);
                    return;
                }

                if (confirm(`确定要删除选中的 ${selectedItemsCount} 件商品吗？`)) {
                    // 过滤掉选中的商品
                    cartItems = cartItems.filter(item => !item.selected);
                    updateCartUI();
                    showToast('删除成功', `已删除 ${selectedItemsCount} 件商品`);
                }
            });

            // 加入收藏
            document.getElementById('addToFavoritesBtn').addEventListener('click', () => {
                const selectedItems = cartItems.filter(item => item.selected);

                if (selectedItems.length === 0) {
                    showToast('操作失败', '请先选择要收藏的商品', false);
                    return;
                }

                // 模拟加入收藏操作
                showToast('收藏成功', `已将 ${selectedItems.length} 件商品添加到收藏夹`);
            });

            // 提交订单
            document.getElementById('checkoutBtn').addEventListener('click', () => {
                const selectedItems = cartItems.filter(item => item.selected);

                if (selectedItems.length === 0) {
                    showToast('操作失败', '请先选择要购买的商品', false);
                    return;
                }

                {#// 跳转到结算页面#}
                {# window.location.href = {% url 'checkout' product_id %}#}
                
            });

            // 关闭通知提示框
            document.getElementById('closeToast').addEventListener('click', hideToast);

            // 点击页面其他地方关闭下拉菜单
            document.addEventListener('click', (e) => {
                if (!moreButton.contains(e.target) && !moreOptions.contains(e.target)) {
                    moreOptions.classList.add('hidden');
                }

                if (!userAvatar.contains(e.target) && !userOptions.contains(e.target)) {
                    userOptions.classList.add('hidden');
                }
            });

            // 滚动时导航栏效果
            window.addEventListener('scroll', () => {
                const header = document.querySelector('header');
                if (window.scrollY > 50) {
                    header.classList.add('shadow-md');
                    header.classList.remove('shadow-sm');
                } else {
                    header.classList.remove('shadow-md');
                    header.classList.add('shadow-sm');
                }
            });
        });
    </script>
</body>

</html>