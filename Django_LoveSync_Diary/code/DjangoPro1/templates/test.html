<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LoveSync 情侣商城 - 为爱定制，共享美好</title>
    {% load static %}
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#FF6B8B', // 爱情粉色作为主色调
                        secondary: '#722ED1', // 紫色作为辅助色
                        neutral: {
                            100: '#F9F9F9',
                            200: '#F0F0F0',
                            300: '#E0E0E0',
                            400: '#BDBDBD',
                            500: '#9E9E9E',
                            600: '#757575',
                            700: '#616161',
                            800: '#424242',
                            900: '#212121',
                        }
                    },
                    fontFamily: {
                        inter: ['Inter', 'sans-serif'],
                    },
                },
            }
        }
    </script>
    <style type="text/tailwindcss">
        @layer utilities {
            .transition-custom {
                transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            }

            .bg-gradient-love {
                background: linear-gradient(135deg, #FF6B8B 0%, #722ED1 100%);
            }

            .hover-scale {
                transition: transform 0.3s ease;
            }

            .hover-scale:hover {
                transform: scale(1.03);
            }

            .form-input-focus {
                transition: all 0.3s ease;
            }

            .form-input-focus:focus {
                transform: translateY(-2px);
                box-shadow: 0 10px 25px -5px rgba(255, 107, 139, 0.1), 0 10px 10px -5px rgba(255, 107, 139, 0.04);
            }

            .btn-pulse {
                animation: pulse 2s infinite;
            }

            @keyframes pulse {
                0% {
                    box-shadow: 0 0 0 0 rgba(255, 107, 139, 0.4);
                }
                70% {
                    box-shadow: 0 0 0 10px rgba(255, 107, 139, 0);
                }
                100% {
                    box-shadow: 0 0 0 0 rgba(255, 107, 139, 0);
                }
            }

            .float-animation {
                animation: float 6s ease-in-out infinite;
            }

            @keyframes float {
                0% {
                    transform: translateY(0px);
                }
                50% {
                    transform: translateY(-20px);
                }
                100% {
                    transform: translateY(0px);
                }
            }

            .product-card {
                transition: all 0.3s ease;
            }

            .product-card:hover {
                box-shadow: 0 15px 30px rgba(0, 0, 0, 0.1);
                transform: translateY(-5px);
            }

            /* 自定义收藏和购物车图标样式 */
            .custom-icon {
                font-size: 1.8rem;
            }

            /* 自定义徽章样式 */
            .custom-badge {
                width: 16px;
                height: 16px;
                font-size: 10px;
                line-height: 16px;
            }

            .category-active {
                background: linear-gradient(135deg, #FF6B8B 0%, #722ED1 100%);
                color: white;
            }

            .scrollbar-hide::-webkit-scrollbar {
                display: none;
            }

            .scrollbar-hide {
                -ms-overflow-style: none;
                scrollbar-width: none;
            }

            .text-shadow {
                text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            }

            .text-gradient {
                background-clip: text;
                -webkit-background-clip: text;
                color: transparent;
                background-image: linear-gradient(135deg, #FF6B8B 0%, #722ED1 100%);
            }

            .card-shadow {
                box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.05), 0 10px 10px -5px rgba(0, 0, 0, 0.01);
            }
        }
    </style>
</head>
<body class="font-inter bg-neutral-100 text-neutral-800 min-h-screen flex flex-col overflow-x-hidden relative">
    <!-- 背景装饰元素 -->
    <div class="absolute top-0 left-0 w-full h-full overflow-hidden pointer-events-none">
        <div class="absolute -top-40 -left-40 w-80 h-80 bg-primary/10 rounded-full filter blur-3xl float-animation"></div>
        <div class="absolute -bottom-20 -right-20 w-80 h-80 bg-secondary/10 rounded-full filter blur-3xl float-animation" style="animation-delay: -2s;"></div>
        <div class="absolute top-1/3 right-1/4 w-40 h-40 bg-primary/5 rounded-full filter blur-2xl float-animation" style="animation-delay: -4s;"></div>
    </div>

    <!-- 导航栏 -->
    <header class="fixed w-full top-0 z-50 transition-all duration-300 bg-white/95 backdrop-blur-md shadow-sm py-3">
        <div class="container mx-auto px-4 flex items-center justify-between">
            <!-- 品牌标识 -->
            <a href="{% url 'index' %}" class="flex items-center space-x-2">
                <div class="w-10 h-10 rounded-full bg-gradient-love flex items-center justify-center text-white shadow-md">
                    <i class="fa-solid fa-heart text-xl"></i>
                </div>
                <span class="text-xl font-bold text-neutral-800 tracking-tight">LoveSync</span>
            </a>

            <!-- 桌面端导航菜单 -->
            <nav class="hidden md:flex items-center space-x-6">
                <a href="{% url 'community' %}" class="text-neutral-700 hover:text-primary transition-custom font-medium px-1 py-2 border-b-2 border-transparent hover:border-primary">爱享公社</a>
                <a href="{% url 'moments' %}" class="text-neutral-700 hover:text-primary transition-custom font-medium px-1 py-2 border-b-2 border-transparent hover:border-primary">心动轨迹</a>
                <a href="{% url 'photo_album' %}" class="text-neutral-700 hover:text-primary transition-custom font-medium px-1 py-2 border-b-2 border-transparent hover:border-primary">心跳相簿</a>
                <a href="{% url 'lovesync' %}" class="text-neutral-700 hover:text-primary transition-custom font-medium px-1 py-2 border-b-2 border-transparent hover:border-primary">双人日记</a>

                <!-- 更多下拉菜单 -->
                <div class="relative" id="moreDropdown">
                    <button class="text-neutral-700 hover:text-primary transition-custom font-medium flex items-center px-1 py-2" id="moreButton">
                        更多 <i class="fa-solid fa-chevron-down ml-1 text-xs"></i>
                    </button>
                    <div class="absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-xl py-2 z-50 hidden" id="moreOptions">
                        <a href="#" class="block px-4 py-2 text-neutral-700 hover:bg-neutral-50 transition-custom flex items-center">
                            <i class="fa-solid fa-calendar-heart mr-2 w-5 text-center"></i>纪念日提醒
                        </a>
                        <a href="#" class="block px-4 py-2 text-neutral-700 hover:bg-neutral-50 transition-custom flex items-center">
                            <i class="fa-solid fa-gift mr-2 w-5 text-center"></i>礼物推荐
                        </a>
                        <a href="#" class="block px-4 py-2 text-neutral-700 hover:bg-neutral-50 transition-custom flex items-center">
                            <i class="fa-solid fa-map-marker-heart mr-2 w-5 text-center"></i>情侣地点
                        </a>
                        <a href="#" class="block px-4 py-2 text-neutral-700 hover:bg-neutral-50 transition-custom flex items-center">
                            <i class="fa-solid fa-question-circle mr-2 w-5 text-center"></i>爱情测试
                        </a>
                    </div>
                </div>
            </nav>

            <!-- 移动端菜单按钮 -->
            <button id="menu-toggle" class="md:hidden text-neutral-700 hover:text-primary transition-custom">
                <i class="fa-solid fa-bars text-xl"></i>
            </button>

            <!-- 移动端菜单 -->
            <div id="mobile-menu" class="md:hidden absolute top-full left-0 w-full bg-white shadow-lg py-4 px-4 hidden opacity-0 -translate-y-2 transition-all duration-200">
                <nav class="flex flex-col space-y-3">
                    <a href="{% url 'community' %}" class="text-neutral-700 hover:text-primary transition-custom font-medium px-2 py-2">爱享公社</a>
                    <a href="{% url 'moments' %}" class="text-neutral-700 hover:text-primary transition-custom font-medium px-2 py-2">心动轨迹</a>
                    <a href="{% url 'photo_album' %}" class="text-neutral-700 hover:text-primary transition-custom font-medium px-2 py-2">心跳相簿</a>
                    <a href="{% url 'lovesync' %}" class="text-neutral-700 hover:text-primary transition-custom font-medium px-2 py-2">双人日记</a>
                    <div class="border-t border-neutral-200 my-2"></div>
                    <a href="#" class="text-neutral-700 hover:text-primary transition-custom font-medium px-2 py-2 flex items-center">
                        <i class="fa-solid fa-calendar-heart mr-2 w-5 text-center"></i>纪念日提醒
                    </a>
                    <a href="#" class="text-neutral-700 hover:text-primary transition-custom font-medium px-2 py-2 flex items-center">
                        <i class="fa-solid fa-gift mr-2 w-5 text-center"></i>礼物推荐
                    </a>
                    <a href="#" class="text-neutral-700 hover:text-primary transition-custom font-medium px-2 py-2 flex items-center">
                        <i class="fa-solid fa-map-marker-heart mr-2 w-5 text-center"></i>情侣地点
                    </a>
                    <a href="#" class="text-neutral-700 hover:text-primary transition-custom font-medium px-2 py-2 flex items-center">
                        <i class="fa-solid fa-question-circle mr-2 w-5 text-center"></i>爱情测试
                    </a>
                </nav>
            </div>

            <!-- 搜索框 -->
            <div class="bg-white/95 backdrop-blur-md rounded-xl shadow-lg p-2 flex justify-between items-center hover-scale w-full max-w-md">

                <div class="relative w-full">
                    <input type="text" id="search-input" placeholder="搜索情侣商品..."
                           class="pl-10 pr-40 py-2 rounded-full border border-neutral-200 focus:outline-none focus:ring-2 focus:ring-primary/50 form-input-focus text-sm w-full">
                    <i class="fa-solid fa-search absolute left-4 top-1/2 -translate-y-1/2 text-neutral-400"></i>

                    <!-- 搜索热词下拉菜单 -->
                    <div id="searchSuggestions" class="absolute left-0 right-0 top-full mt-1 bg-white rounded-xl shadow-xl z-40 invisible opacity-0 transform -translate-y-2 transition-all duration-200">
                        <div class="p-3">
                            <div class="flex justify-between items-center mb-2">
                                <h4 class="font-medium text-neutral-800">热门搜索</h4>
                                <button id="clear-history" class="text-xs text-neutral-500 hover:text-primary">清除历史</button>
                            </div>

                            <div class="space-y-2" id="search-history">
                                <!-- 搜索历史会动态生成 -->
                            </div>

                            <div class="mt-3 pt-3 border-t border-neutral-100">
                                <h4 class="font-medium text-neutral-800 mb-2">热门推荐</h4>
                                <div class="grid grid-cols-2 gap-2">
                                    <a href="#" class="px-3 py-2 bg-neutral-50 rounded-full text-sm text-neutral-700 hover:bg-primary/10 hover:text-primary transition-custom truncate">情侣手链</a>
                                    <a href="#" class="px-3 py-2 bg-neutral-50 rounded-full text-sm text-neutral-700 hover:bg-primary/10 hover:text-primary transition-custom truncate">定制戒指</a>
                                    <a href="#" class="px-3 py-2 bg-neutral-50 rounded-full text-sm text-neutral-700 hover:bg-primary/10 hover:text-primary transition-custom truncate">情侣装</a>
                                    <a href="#" class="px-3 py-2 bg-neutral-50 rounded-full text-sm text-neutral-700 hover:bg-primary/10 hover:text-primary transition-custom truncate">爱情相册</a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- 分类筛选 -->
    <div class="pt-24 pb-6 px-4">
        <div class="container mx-auto">
            <div class="flex items-center justify-between mb-6">
                <h2 class="text-2xl font-bold text-neutral-800">情侣商城</h2>
                <div class="flex items-center space-x-3">
                    <button class="text-sm text-neutral-600 hover:text-primary transition-custom">
                        <i class="fa-solid fa-sliders mr-1"></i> 筛选
                    </button>
                    <button class="text-sm text-neutral-600 hover:text-primary transition-custom">
                        <i class="fa-solid fa-sort mr-1"></i> 排序
                    </button>
                </div>
            </div>

            <div class="overflow-x-auto scrollbar-hide">
                <div class="flex space-x-3 pb-2 min-w-max">
                    <button class="px-5 py-2 rounded-full bg-primary text-white font-medium transition-custom">全部商品</button>
                    <button class="px-5 py-2 rounded-full bg-white text-neutral-700 font-medium hover:bg-primary/10 hover:text-primary transition-custom">情侣首饰</button>
                    <button class="px-5 py-2 rounded-full bg-white text-neutral-700 font-medium hover:bg-primary/10 hover:text-primary transition-custom">情侣服饰</button>
                    <button class="px-5 py-2 rounded-full bg-white text-neutral-700 font-medium hover:bg-primary/10 hover:text-primary transition-custom">家居用品</button>
                    <button class="px-5 py-2 rounded-full bg-white text-neutral-700 font-medium hover:bg-primary/10 hover:text-primary transition-custom">创意礼品</button>
                    <button class="px-5 py-2 rounded-full bg-white text-neutral-700 font-medium hover:bg-primary/10 hover:text-primary transition-custom">旅行装备</button>
                    <button class="px-5 py-2 rounded-full bg-white text-neutral-700 font-medium hover:bg-primary/10 hover:text-primary transition-custom">数码产品</button>
                </div>
            </div>
        </div>
    </div>

    <!-- 商品展示区 -->
    <div class="container mx-auto px-4 pb-16">
        <div id="products-grid" class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-5">
            <!-- 商品卡片将通过JavaScript动态生成 -->
        </div>

        <!-- 加载更多 -->
        <div class="mt-10 text-center">
            <button id="load-more" class="px-8 py-3 bg-white border border-neutral-200 rounded-full text-neutral-700 hover:bg-primary hover:text-white hover:border-primary transition-custom">
                加载更多 <i class="fa-solid fa-angle-down ml-1"></i>
            </button>
        </div>
    </div>

    <!-- 页脚 -->
    <footer class="bg-white border-t border-neutral-200">
        <div class="container mx-auto px-4 py-10">
            <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
                <div>
                    <div class="flex items-center space-x-2 mb-4">
                        <div class="w-10 h-10 rounded-full bg-gradient-love flex items-center justify-center text-white shadow-sm">
                            <i class="fa-solid fa-heart text-xl"></i>
                        </div>
                        <span class="text-xl font-bold text-neutral-800 tracking-tight">LoveSync</span>
                    </div>
                    <p class="text-neutral-600 text-sm mb-4">为爱定制的情侣互动平台，记录每一刻心动瞬间。</p>
                    <div class="flex space-x-4">
                        <a href="#" class="text-neutral-500 hover:text-primary transition-custom">
                            <i class="fa-brands fa-weibo text-lg"></i>
                        </a>
                        <a href="#" class="text-neutral-500 hover:text-primary transition-custom">
                            <i class="fa-brands fa-wechat text-lg"></i>
                        </a>
                        <a href="#" class="text-neutral-500 hover:text-primary transition-custom">
                            <i class="fa-brands fa-instagram text-lg"></i>
                        </a>
                    </div>
                </div>

                <div>
                    <h4 class="font-medium text-neutral-800 mb-4">功能导航</h4>
                    <ul class="space-y-2">
                        <li><a href="#" class="text-neutral-600 hover:text-primary transition-custom">爱享公社</a></li>
                        <li><a href="#" class="text-neutral-600 hover:text-primary transition-custom">心动轨迹</a></li>
                        <li><a href="#" class="text-neutral-600 hover:text-primary transition-custom">心跳相簿</a></li>
                        <li><a href="#" class="text-neutral-600 hover:text-primary transition-custom">双人日记</a></li>
                        <li><a href="#" class="text-neutral-600 hover:text-primary transition-custom">情侣商城</a></li>
                    </ul>
                </div>

                <div>
                    <h4 class="font-medium text-neutral-800 mb-4">帮助中心</h4>
                    <ul class="space-y-2">
                        <li><a href="#" class="text-neutral-600 hover:text-primary transition-custom">使用指南</a></li>
                        <li><a href="#" class="text-neutral-600 hover:text-primary transition-custom">常见问题</a></li>
                        <li><a href="#" class="text-neutral-600 hover:text-primary transition-custom">联系我们</a></li>
                        <li><a href="#" class="text-neutral-600 hover:text-primary transition-custom">意见反馈</a></li>
                        <li><a href="#" class="text-neutral-600 hover:text-primary transition-custom">隐私政策</a></li>
                    </ul>
                </div>

                <div>
                    <h4 class="font-medium text-neutral-800 mb-4">关注我们</h4>
                    <p class="text-neutral-600 text-sm mb-4">扫描二维码，下载LoveSync应用</p>
                    <div class="bg-neutral-100 p-3 inline-block rounded-lg">
                        <img src="https://picsum.photos/100/100" alt="LoveSync应用二维码" class="w-24 h-24">
                    </div>
                </div>
            </div>

            <div class="mt-10 pt-6 border-t border-neutral-200 text-center text-neutral-500 text-sm">
                <p>© 2025 LoveSync. 保留所有权利。</p>
            </div>
        </div>
    </footer>

    <script>
        // 模拟商品数据
        const products = [
            {
                id: 1,
                name: "情侣手链套装",
                price: 199.00,
                image: "https://picsum.photos/seed/couple1/300/300",
                rating: 4.8,
                num_reviews: 234,
                category: "情侣首饰"
            },
            {
                id: 2,
                name: "定制情侣戒指",
                price: 599.00,
                image: "https://picsum.photos/seed/couple2/300/300",
                rating: 4.9,
                num_reviews: 187,
                category: "情侣首饰"
            },
            {
                id: 3,
                name: "创意情侣手机壳",
                price: 79.00,
                image: "https://picsum.photos/seed/couple3/300/300",
                rating: 4.5,
                num_reviews: 342,
                category: "创意礼品"
            },
            {
                id: 4,
                name: "情侣保温杯套装",
                price: 159.00,
                image: "https://picsum.photos/seed/couple4/300/300",
                rating: 4.7,
                num_reviews: 215,
                category: "家居用品"
            },
            {
                id: 5,
                name: "情侣旅行背包",
                price: 399.00,
                image: "https://picsum.photos/seed/couple5/300/300",
                rating: 4.6,
                num_reviews: 163,
                category: "旅行装备"
            },
            {
                id: 6,
                name: "情侣睡衣套装",
                price: 249.00,
                image: "https://picsum.photos/seed/couple6/300/300",
                rating: 4.8,
                num_reviews: 276,
                category: "情侣服饰"
            },
            {
                id: 7,
                name: "爱情密码锁盒",
                price: 129.00,
                image: "https://picsum.photos/seed/couple7/300/300",
                rating: 4.4,
                num_reviews: 198,
                category: "创意礼品"
            },
            {
                id: 8,
                name: "情侣马克杯",
                price: 89.00,
                image: "https://picsum.photos/seed/couple8/300/300",
                rating: 4.7,
                num_reviews: 256,
                category: "家居用品"
            },
            {
                id: 9,
                name: "情侣手表套装",
                price: 899.00,
                image: "https://picsum.photos/seed/couple9/300/300",
                rating: 4.9,
                num_reviews: 143,
                category: "情侣首饰"
            },
            {
                id: 10,
                name: "定制情侣T恤",
                price: 169.00,
                image: "https://picsum.photos/seed/couple10/300/300",
                rating: 4.6,
                num_reviews: 312,
                category: "情侣服饰"
            },
            {
                id: 11,
                name: "爱情主题拼图",
                price: 69.00,
                image: "https://picsum.photos/seed/couple11/300/300",
                rating: 4.5,
                num_reviews: 207,
                category: "创意礼品"
            },
            {
                id: 12,
                name: "情侣运动手环",
                price: 229.00,
                image: "https://picsum.photos/seed/couple12/300/300",
                rating: 4.7,
                num_reviews: 189,
                category: "数码产品"
            },
            {
                id: 13,
                name: "情侣摄影道具套装",
                price: 189.00,
                image: "https://picsum.photos/seed/couple13/300/300",
                rating: 4.8,
                num_reviews: 156,
                category: "创意礼品"
            },
            {
                id: 14,
                name: "定制情侣钥匙扣",
                price: 59.00,
                image: "https://picsum.photos/seed/couple14/300/300",
                rating: 4.6,
                num_reviews: 245,
                category: "创意礼品"
            },
            {
                id: 15,
                name: "情侣香薰蜡烛套装",
                price: 139.00,
                image: "https://picsum.photos/seed/couple15/300/300",
                rating: 4.4,
                num_reviews: 178,
                category: "家居用品"
            }
        ];

        // 页面加载完成后执行
        document.addEventListener('DOMContentLoaded', function() {
            // 渲染商品列表
            renderProducts(products);

            // 初始化搜索功能
            initSearch();

            // 初始化分类筛选
            initCategoryFilter();

            // 初始化移动端菜单
            initMobileMenu();

            // 初始化加载更多功能
            initLoadMore();
        });

        // 渲染商品列表
        function renderProducts(productsList) {
            const productsGrid = document.getElementById('products-grid');
            productsGrid.innerHTML = '';

            if (productsList.length === 0) {
                productsGrid.innerHTML = `
                    <div class="col-span-full text-center py-10">
                        <i class="fa-regular fa-face-sad-tear text-5xl text-neutral-300 mb-4"></i>
                        <p class="text-neutral-500">没有找到相关商品</p>
                        <button id="reset-search" class="mt-4 px-5 py-2 bg-primary/10 text-primary rounded-full hover:bg-primary hover:text-white transition-custom">
                            清除筛选条件
                        </button>
                    </div>
                `;
                return;
            }

            productsList.forEach(product => {
                const productCard = document.createElement('div');
                productCard.className = 'bg-white rounded-xl overflow-hidden shadow-sm product-card';
                productCard.innerHTML = `
                    <div class="relative">
                        <img src="${product.image}" alt="${product.name}" class="w-full h-48 object-cover">
                        <button class="absolute top-2 right-2 w-8 h-8 rounded-full bg-white/80 flex items-center justify-center text-neutral-500 hover:text-primary transition-custom">
                            <i class="fa-regular fa-heart"></i>
                        </button>
                        <div class="absolute bottom-2 left-2 px-2 py-1 bg-primary/90 text-white text-xs rounded-full">
                            ${product.category}
                        </div>
                    </div>
                    <div class="p-3">
                        <h3 class="font-medium text-neutral-800 text-sm line-clamp-2">${product.name}</h3>
                        <div class="mt-2 flex items-center justify-between">
                            <span class="text-primary font-bold">¥${product.price.toFixed(2)}</span>
                            <div class="flex items-center text-yellow-400 text-xs">
                                ${generateRatingStars(product.rating)}
                                <span class="text-neutral-500 ml-1">${product.rating}</span>
                            </div>
                        </div>
                        <div class="mt-3 flex space-x-2">
                            <button class="flex-1 py-1.5 bg-primary/10 text-primary rounded-full text-sm hover:bg-primary hover:text-white transition-custom">
                                <i class="fa-solid fa-shopping-cart mr-1"></i> 加入购物车
                            </button>
                            <button class="w-8 h-8 flex items-center justify-center border border-neutral-200 rounded-full text-neutral-600 hover:text-primary hover:border-primary transition-custom">
                                <i class="fa-solid fa-eye"></i>
                            </button>
                        </div>
                    </div>
                `;
                productsGrid.appendChild(productCard);
            });
        }

        // 生成评分星星
        function generateRatingStars(rating) {
            let stars = '';
            const fullStars = Math.floor(rating);
            const halfStar = rating % 1 >= 0.5;

            for (let i = 1; i <= 5; i++) {
                if (i <= fullStars) {
                    stars += '<i class="fa-solid fa-star"></i>';
                } else if (i === fullStars + 1 && halfStar) {
                    stars += '<i class="fa-solid fa-star-half-stroke"></i>';
                } else {
                    stars += '<i class="fa-regular fa-star"></i>';
                }
            }

            return stars;
        }

        // 初始化搜索功能
        function initSearch() {
            const searchInput = document.getElementById('search-input');
            const searchSuggestions = document.getElementById('searchSuggestions');
            const searchHistory = document.getElementById('search-history');
            const clearHistoryBtn = document.getElementById('clear-history');

            // 从本地存储获取搜索历史
            const getSearchHistory = () => {
                const history = localStorage.getItem('searchHistory');
                return history ? JSON.parse(history) : [];
            };

            // 保存搜索历史到本地存储
            const saveSearchHistory = (history) => {
                localStorage.setItem('searchHistory', JSON.stringify(history));
            };

            // 渲染搜索历史
            const renderSearchHistory = () => {
                const history = getSearchHistory();
                searchHistory.innerHTML = '';

                if (history.length === 0) {
                    searchHistory.innerHTML = '<p class="text-neutral-500 text-sm">暂无搜索历史</p>';
                    return;
                }

                history.forEach((term, index) => {
                    const historyItem = document.createElement('a');
                    historyItem.href = '#';
                    historyItem.className = 'flex items-center justify-between p-2 hover:bg-neutral-50 rounded-lg transition-custom';
                    historyItem.innerHTML = `
                        <div class="flex items-center">
                            <i class="fa-solid fa-clock-rotate-left text-neutral-400 mr-2"></i>
                            <span class="text-neutral-700">${term}</span>
                        </div>
                        <button class="text-neutral-400 hover:text-primary" data-index="${index}">
                            <i class="fa-solid fa-xmark"></i>
                        </button>
                    `;

                    // 点击搜索历史项
                    historyItem.addEventListener('click', function(e) {
                        e.preventDefault();
                        searchInput.value = term;
                        searchSuggestions.classList.add('invisible', 'opacity-0', 'transform', '-translate-y-2');

                        // 模拟搜索结果
                        const filteredProducts = products.filter(product =>
                            product.name.toLowerCase().includes(term.toLowerCase())
                        );
                        renderProducts(filteredProducts);
                    });

                    // 删除单个历史项
                    historyItem.querySelector('button').addEventListener('click', function(e) {
                        e.stopPropagation();
                        const index = parseInt(this.getAttribute('data-index'));
                        const history = getSearchHistory();
                        history.splice(index, 1);
                        saveSearchHistory(history);
                        renderSearchHistory();
                    });

                    searchHistory.appendChild(historyItem);
                });
            };

            // 清除所有搜索历史
            clearHistoryBtn.addEventListener('click', function() {
                localStorage.removeItem('searchHistory');
                renderSearchHistory();
            });

            // 搜索输入框聚焦
            searchInput.addEventListener('focus', function() {
                searchSuggestions.classList.remove('invisible', 'opacity-0', 'transform', '-translate-y-2');
                renderSearchHistory();
            });

            // 搜索输入框失焦
            searchInput.addEventListener('blur', function() {
                setTimeout(() => {
                    searchSuggestions.classList.add('invisible', 'opacity-0', 'transform', '-translate-y-2');
                }, 200);
            });

            // 实时搜索
            searchInput.addEventListener('input', function() {
                const searchTerm = this.value.trim().toLowerCase();

                if (searchTerm === '') {
                    renderSearchHistory();
                    return;
                }

                // 过滤商品
                const filteredProducts = products.filter(product =>
                    product.name.toLowerCase().includes(searchTerm)
                );

                // 渲染搜索建议
                searchHistory.innerHTML = '';

                if (filteredProducts.length === 0) {
                    searchHistory.innerHTML = '<p class="text-neutral-500 text-sm">没有找到相关商品</p>';
                    return;
                }

                filteredProducts.slice(0, 5).forEach(product => {
                    const suggestionItem = document.createElement('a');
                    suggestionItem.href = '#';
                    suggestionItem.className = 'flex items-center p-2 hover:bg-neutral-50 rounded-lg transition-custom';
                    suggestionItem.innerHTML = `
                        <img src="${product.image}" alt="${product.name}" class="w-10 h-10 object-cover rounded mr-3">
                        <div class="flex-1">
                            <p class="text-neutral-700 text-sm font-medium">${highlightSearchTerm(product.name, searchTerm)}</p>
                            <p class="text-primary text-xs">¥${product.price.toFixed(2)}</p>
                        </div>
                    `;

                    // 点击搜索建议
                    suggestionItem.addEventListener('click', function(e) {
                        e.preventDefault();
                        searchInput.value = product.name;
                        searchSuggestions.classList.add('invisible', 'opacity-0', 'transform', '-translate-y-2');

                        // 保存搜索历史
                        const history = getSearchHistory();
                        const index = history.indexOf(product.name);
                        if (index !== -1) {
                            history.splice(index, 1);
                        }
                        history.unshift(product.name);
                        if (history.length > 5) {
                            history.pop();
                        }
                        saveSearchHistory(history);

                        // 渲染搜索结果
                        const filtered = products.filter(p =>
                            p.name.toLowerCase().includes(searchTerm)
                        );
                        renderProducts(filtered);
                    });

                    searchHistory.appendChild(suggestionItem);
                });
            });

            // 搜索按钮点击
            document.querySelector('.fa-search').parentElement.addEventListener('click', function() {
                const searchTerm = searchInput.value.trim();

                if (searchTerm === '') {
                    return;
                }

                // 保存搜索历史
                const history = getSearchHistory();
                const index = history.indexOf(searchTerm);
                if (index !== -1) {
                    history.splice(index, 1);
                }
                history.unshift(searchTerm);
                if (history.length > 5) {
                    history.pop();
                }
                saveSearchHistory(history);

                // 过滤商品
                const filteredProducts = products.filter(product =>
                    product.name.toLowerCase().includes(searchTerm.toLowerCase())
                );

                // 隐藏搜索建议
                searchSuggestions.classList.add('invisible', 'opacity-0', 'transform', '-translate-y-2');

                // 渲染搜索结果
                renderProducts(filteredProducts);
            });

            // 重置搜索
            document.addEventListener('click', function(e) {
                if (e.target.id === 'reset-search') {
                    searchInput.value = '';
                    renderProducts(products);
                }
            });

            // 高亮搜索词
            function highlightSearchTerm(text, term) {
                if (!term) return text;
                const regex = new RegExp(`(${term})`, 'gi');
                return text.replace(regex, '<span class="bg-yellow-100">$1</span>');
            }
        }

        // 初始化分类筛选
        function initCategoryFilter() {
            const categoryButtons = document.querySelectorAll('.overflow-x-auto button');

            categoryButtons.forEach(button => {
                button.addEventListener('click', function() {
                    // 重置所有按钮样式
                    categoryButtons.forEach(btn => {
                        btn.classList.remove('bg-primary', 'text-white');
                        btn.classList.add('bg-white', 'text-neutral-700', 'hover:bg-primary/10', 'hover:text-primary');
                    });

                    // 设置当前按钮样式
                    this.classList.remove('bg-white', 'text-neutral-700', 'hover:bg-primary/10', 'hover:text-primary');
                    this.classList.add('bg-primary', 'text-white');

                    const category = this.textContent.trim();

                    if (category === '全部商品') {
                        renderProducts(products);
                        return;
                    }

                    // 过滤商品
                    const filteredProducts = products.filter(product =>
                        product.category === category
                    );

                    renderProducts(filteredProducts);
                });
            });
        }

        // 初始化移动端菜单
        function initMobileMenu() {
            const menuToggle = document.getElementById('menu-toggle');
            const mobileMenu = document.getElementById('mobile-menu');

            menuToggle.addEventListener('click', function() {
                if (mobileMenu.classList.contains('hidden')) {
                    mobileMenu.classList.remove('hidden', 'opacity-0', '-translate-y-2');
                    mobileMenu.classList.add('opacity-100', 'translate-y-0');
                } else {
                    mobileMenu.classList.add('opacity-0', '-translate-y-2');
                    setTimeout(() => {
                        mobileMenu.classList.add('hidden');
                    }, 200);
                }
            });
        }

        // 初始化加载更多功能
        function initLoadMore() {
            const loadMoreBtn = document.getElementById('load-more');
            let currentPage = 1;
            const productsPerPage = 15;

            loadMoreBtn.addEventListener('click', function() {
                // 模拟加载状态
                this.innerHTML = '<i class="fa-solid fa-spinner fa-spin mr-1"></i> 加载中...';
                this.disabled = true;

                // 模拟网络请求延迟
                setTimeout(() => {
                    // 这里应该从后端获取下一页数据
                    // 为了演示，我们只是复制现有数据
                    const nextPageProducts = [...products].map(product => ({
                        ...product,
                        id: product.id + products.length * currentPage
                    }));

                    // 将新数据添加到现有网格
                    const productsGrid = document.getElementById('products-grid');

                    // 检查是否是第一页加载
                    if (currentPage === 1 && productsGrid.querySelector('.col-span-full')) {
                        productsGrid.innerHTML = '';
                    }

                    nextPageProducts.forEach(product => {
                        const productCard = document.createElement('div');
                        productCard.className = 'bg-white rounded-xl overflow-hidden shadow-sm product-card';
                        productCard.innerHTML = `
                            <div class="relative">
                                <img src="${product.image}" alt="${product.name}" class="w-full h-48 object-cover">
                                <button class="absolute top-2 right-2 w-8 h-8 rounded-full bg-white/80 flex items-center justify-center text-neutral-500 hover:text-primary transition-custom">
                                    <i class="fa-regular fa-heart"></i>
                                </button>
                                <div class="absolute bottom-2 left-2 px-2 py-1 bg-primary/90 text-white text-xs rounded-full">
                                    ${product.category}
                                </div>
                            </div>
                            <div class="p-3">
                                <h3 class="font-medium text-neutral-800 text-sm line-clamp-2">${product.name}</h3>
                                <div class="mt-2 flex items-center justify-between">
                                    <span class="text-primary font-bold">¥${product.price.toFixed(2)}</span>
                                    <div class="flex items-center text-yellow-400 text-xs">
                                        ${generateRatingStars(product.rating)}
                                        <span class="text-neutral-500 ml-1">${product.rating}</span>
                                    </div>
                                </div>
                                <div class="mt-3 flex space-x-2">
                                    <button class="flex-1 py-1.5 bg-primary/10 text-primary rounded-full text-sm hover:bg-primary hover:text-white transition-custom">
                                        <i class="fa-solid fa-shopping-cart mr-1"></i> 加入购物车
                                    </button>
                                    <button class="w-8 h-8 flex items-center justify-center border border-neutral-200 rounded-full text-neutral-600 hover:text-primary hover:border-primary transition-custom">
                                        <i class="fa-solid fa-eye"></i>
                                    </button>
                                </div>
                            </div>
                        `;
                        productsGrid.appendChild(productCard);
                    });

                    // 更新页码和按钮状态
                    currentPage++;

                    // 模拟没有更多数据的情况
                    if (currentPage > 3) {
                        this.innerHTML = '<i class="fa-solid fa-check mr-1"></i> 已加载全部商品';
                        this.classList.remove('bg-white', 'border', 'border-neutral-200', 'text-neutral-700', 'hover:bg-primary', 'hover:text-white', 'hover:border-primary');
                        this.classList.add('bg-green-500', 'text-white');
                        this.disabled = true;
                    } else {
                        this.innerHTML = '加载更多 <i class="fa-solid fa-angle-down ml-1"></i>';
                        this.disabled = false;
                    }
                }, 1000);
            });
        }
    </script>
</body>
</html>